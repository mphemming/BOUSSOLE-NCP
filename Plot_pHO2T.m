
%% prepare for plot

O2_mmol = (prcdata.timeseries.sigma0/1000) .* prcdata.timeseries.O2;

x1rg = [8.03:0.01:8.26];
x2rg = [180:1:290];

check = ~isnan(prcdata.timeseries.pH_recalibrated) & ~isnan(O2_mmol) & ~isnan(prcdata.timeseries.t) & prcdata.timeseries.P <=46;
t_bin = bindata2(...
    [prcdata.timeseries.t(check)],... % Value to grid
    [prcdata.timeseries.pH_recalibrated(check)],[O2_mmol(check)],... %x1 and x2 in the script, or your x and y locations in more general terms
    x1rg,x2rg);

% contour(x1rg(1:end-1),x2rg(1:end-1),smoothn(t_bin,20),[datenum(2016,03,19,00,00,00) datenum(2016,03,29,00,00,00)],'LineColor','k','ShowText','On')

%% create figure

figure('units','normalized','position',[0 0 .6 .8]);

hold on
scatter(prcdata.timeseries.pH_recalibrated(prcdata.timeseries.P <=46),O2_mmol(prcdata.timeseries.P <=46),...
    35,prcdata.timeseries.potT(prcdata.timeseries.P <=46),'MarkerFaceColor','k','MarkerEdgeColor','k')
scatter(prcdata.timeseries.pH_recalibrated(prcdata.timeseries.P <=46),O2_mmol(prcdata.timeseries.P <=46),30,...
    prcdata.timeseries.potT(prcdata.timeseries.P <=46),'filled')
caxis([13.2 14])
[c,h] = contour(x1rg(1:end-1),x2rg(1:end-1),smoothn(t_bin,2),[datenum(2016,03,19,00,00,00) datenum(2016,03,28,00,00,00) ],...
    'LineColor','k','ShowText','Off','LineWidth',2)


set(gca,'LineWidth',3,'FontSize',22)
box on
xlim([8.05 8.18])
ylim([200 285])

ylabel('\itc \rm(O_2) [mmol m^{-3}]')
xlabel('pH_T')
c = colorbar
ylabel(c,'\theta [^\circC]')

colormap('Viridis')
caxis([13.2 13.8])
% colormap(flipud(cbrewer('div', 'RdYlBu', 50)))

annotation(gcf,'textbox',...
    [0.145833333333333 0.649305555555555 0.112979166666667 0.0636574074074076],...
    'LineStyle','none',...
    'FitBoxToText','off',...
    'BackgroundColor',[1 1 1]);

annotation(gcf,'textbox',...
    [0.139322916666667 0.643518518518518 0.0316840277777777 0.0480324074074076],...
    'LineStyle','none',...
    'FitBoxToText','off',...
    'BackgroundColor',[1 1 1]);

annotation(gcf,'textbox',...
    [0.64813541666667 0.212384259259259 0.130944444444444 0.0601851851851854],...
    'String',{'March 25'},...
    'LineStyle','none',...
    'FontSize',14,...
    'FitBoxToText','off');

annotation(gcf,'textbox',...
    [0.200218750000001 0.30613425925926 0.130944444444445 0.0601851851851853],...
    'String','March 19',...
    'LineStyle','none',...
    'FontSize',14,...
    'FitBoxToText','off');

annotation(gcf,'textbox',...
    [0.152909722222223 0.774305555555556 0.130944444444445 0.0601851851851853],...
    'String',{'March 25'},...
    'LineStyle','none',...
    'FontSize',14,...
    'FitBoxToText','off');


 print(gcf, '-dpng','-r400', [options.plot_dir,'Fig_O2pHT'])
 
 
 