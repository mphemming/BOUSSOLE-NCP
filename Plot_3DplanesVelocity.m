
%% create figure

figure('units','normalized','position',[0 0 .8 .9]);
    
%% O2 planes
axes1 = axes('Parent',gcf,...
    'Position',[0.13 0.32630811495055 0.386247015649498 0.541342322895068]);

for n = 2:4:10
    [p1] = plot(planes_loop(25).oxygen_planes.gridded_O2fit(n).fit, ...
        [planes_loop(25).oxygen_planes.gridded_O2fit(n).xa_for_fit,planes_loop(25).oxygen_planes.gridded_O2fit(n).ya_for_fit],...
        planes_loop(25).oxygen_planes.gridded_O2fit(n).O2_for_fit);
    hold on
    set(p1(1),'FaceAlpha',0)
   set(p1(2),'MarkerSize',10,'MarkerFaceColor',[.2 .4 .6],'MarkerEdgeColor','k')
end

ax = gca;
ax.BoxStyle = 'full';

set(gca,'FontSize',16,'LineWidth',3)
xlabel('Lon. dist.[m]')
ylabel('Lat. dist. [m]')
zlabel('\itc\rm(O_2) [mmol m^{-3}]')
view(gca,[-25.1114671163575 9.78250950570329]);
zlim([235 260])

% Create textbox
annotation(gcf,'textbox',...
    [0.5176015625 0.535493827160494 0.0628020833333334 0.0586419753086421],...
    'String','45 m',...
    'LineStyle','none',...
    'FontSize',14,...
    'FitBoxToText','off');

% Create textbox
annotation(gcf,'textbox',...
    [0.517601562500001 0.586934156378602 0.0628020833333334 0.0586419753086419],...
    'String','25 m',...
    'LineStyle','none',...
    'FontSize',14,...
    'FitBoxToText','off');

% Create doublearrow
annotation(gcf,'doublearrow',[0.1640625 0.163411458333333],...
    [0.809670781893004 0.380658436213992],'LineWidth',2);

% Create textbox
annotation(gcf,'textbox',...
    [0.517276041666667 0.645061728395062 0.0628020833333334 0.0586419753086421],...
    'String',{'5 m'},...
    'LineStyle','none',...
    'FontSize',14,...
    'FitBoxToText','off');

% Create textbox
annotation(gcf,'textbox',...
    [0.126976562500001 0.592078189300412 0.0628020833333334 0.0586419753086421],...
    'String',{'\itz\rm_{eu}'},...
    'LineStyle','none',...
    'FontSize',18,...
    'FitBoxToText','off');

% Create textbox
annotation(gcf,'textbox',...
    [0.0364817708333338 0.795781893004116 0.0628020833333333 0.0586419753086421],...
    'String','(a)',...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',24,...
    'FitBoxToText','off');

% Create textbox
annotation(gcf,'textbox',...
    [0.578473958333334 0.838477366255145 0.0628020833333333 0.0586419753086421],...
    'String','(b)',...
    'LineStyle','none',...
    'FontWeight','bold',...
    'FontSize',24,...
    'FitBoxToText','off');



%% Velocity profiles

axes('Parent',gcf,...
    'Position',[0.663248697916667 0.274434156378601 0.295572916666667 0.616255144032923]);

hold on       
p0 = plot(ones(1,1000)*means_struct(17).DACu_h,1:1:1000,'LineWidth',3,'LineStyle',':');
p00 = plot(ones(1,1000)*means_struct(17).DACv_h,1:1:1000,'LineWidth',3,'LineStyle',':');
p1col = get(p0,'Color');
p2col = get(p00,'Color');       
p1 = plot(smooth(O2_adv(17).DU,2),options.vertical_grid-1,'LineWidth',3,'LineStyle','--','color',p1col);
p2 = plot(smooth(O2_adv(17).DV,2),options.vertical_grid-1,'LineWidth',3,'LineStyle','--','color',p2col);
 
set(gca,'FontSize',16,'LineWidth',2,'YDir','Reverse','YLim',[2 45])
xlabel('Velocity [m s^{-1}]')
ylabel('Depth [m]')

p3 = plot(smooth(O2_adv(17).DU_abs,2),options.vertical_grid-1,'LineWidth',3,'color',p1col);
p4 = plot(smooth(O2_adv(17).DV_abs,2),options.vertical_grid-1,'LineWidth',3,'color',p2col);

xlim([-0.1 0.075])
box on;
set(gca,'FontSize',22,'LineWidth',3)

l = legend([p0 p00 p1 p2 p3 p4],'\itu_{\rmDAC}','\itv_{\rmDAC}','\itu_{\rmrel}','\itv_{\rmrel}','\itu_{\rmabs}','\itv_{\rmabs}','Location','SouthWest')
set(l,'Box','Off')

%% save figure

print(gcf, '-dpng','-r400', [options.plot_dir,'Fig_planes'])

